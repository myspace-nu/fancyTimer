/*!
 * fancyTimer v1.0.0
 * https://github.com/myspace-nu
 *
 * Copyright 2021 Johan Johansson
 * Released under the MIT license
 */

var fancytimer=function(e){var a=this,o=function a(...e){const o=e=>e&&"object"==typeof e;return e.reduce((n,s)=>(Object.keys(s).forEach(e=>{const t=n[e],i=s[e];Array.isArray(t)&&Array.isArray(i)?n[e]=t.concat(...i):o(t)&&o(i)?n[e]=a(t,i):n[e]=i}),n),{})}({hours:0,minutes:0,seconds:0,showGrains:!0,loop:!1,style:{color:"#aaa","font-style":"Arial","line-width":8},formatter:function(e){return{text:i(Math.ceil(e.remainingms/1e3)),percentDone:e.remainingms/(e.endTime.getTime()-e.startTime.getTime())*100}},onElapsed:function(){},onPause:function(){},onResume:function(){},onStop:function(){},onStart:function(){},onReset:function(){}},e);o.seconds=3600*o.hours+60*o.minutes+o.seconds;function r(){window.clearInterval(a.timer)}function m(){o.loop||r(),a.paused=!1,a.started=!1,a.startTime=o.startTime??new Date,a.endTime=o.endTime??null,a.endTime&&o.seconds&&(a.startTime=new Date(a.endTime.getTime()-1e3*o.seconds)),a.endTime&&!o.seconds&&(a.startTime=new Date),a.endTime=a.endTime??o.seconds?new Date(a.startTime.getTime()+1e3*o.seconds):new Date,o.loop&&(a.startTime=new Date,a.endTime=new Date(a.startTime.getTime()+1e3*o.seconds),a.started=!0),a.elapsedms=0,a.remainingms=o.seconds?1e3*o.seconds:a.endTime.getTime()-a.startTime.getTime()}function h(e,t,i,n,s){e.beginPath(),e.lineWidth=0,s&&(e.fillStyle=s),e.arc(t,i,n,0,2*Math.PI),e.fill()}function l(e,t,i,n){return{x:e+n*Math.cos((i-90)*(Math.PI/180)),y:t+n*Math.sin((i-90)*(Math.PI/180))}}function t(){if(!a.paused){a.startTime&&(new Date).getTime()>a.startTime.getTime()&&(a.elapsedms=(new Date).getTime()-a.startTime.getTime(),a.remainingms=a.endTime.getTime()-(new Date).getTime()),a.remainingms<=0&&(o.loop?m():(r(),a.elapsedms=1e3*o.seconds,a.remainingms=0),o.onElapsed.call(this,a));var e=o.formatter(a),t="object"==typeof e&&"percentDone"in e?e.percentDone/100:a.remainingms/(a.endTime.getTime()-a.startTime.getTime()),i="object"==typeof e&&"text"in e?e.text:e;c.clearRect(0,0,d.width,d.height),c.beginPath(),c.strokeStyle=o.style.color,c.lineWidth=d.width*(o.style["line-width"]/200),c.arc(d.width/2,d.height/2,Math.min(d.width,d.height)/2-c.lineWidth/2,Math.PI/180*-90,(360*t-90)*(Math.PI/180)),c.stroke();var n=l(d.width/2,d.height/2,0,Math.min(d.width,d.height)/2-c.lineWidth/2);if(h(c,n.x,n.y,c.lineWidth/2,o.style.color),n=l(d.width/2,d.height/2,360*t,Math.min(d.width,d.height)/2-c.lineWidth/2),h(c,n.x,n.y,c.lineWidth/2,o.style.color),o.showGrains)for(var s=1;t<s;s-=1/(300/o.style["line-width"])){n=l(d.width/2,d.height/2,360*s,Math.min(d.width,d.height)/2-c.lineWidth/2);h(c,n.x,n.y,c.lineWidth/4,o.style.color)}e=1/((""+i).length/6)*.4,e=Math.min(e,1),e=.5*Math.min(d.width,d.height)*e;c.font=e+"px "+o.style["font-style"],c.fillStyle=o.style.color,c.textAlign="center",c.fillText(i,d.width/2,d.height/2+.75*e/2)}}var i=function(e){e=Math.round(e);var t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),n=e-3600*t-60*(i=3600<=e&&i<10?"0"+i:i),n=60<=e&&n<10?"0"+n:n;return 3600<=e?t+":"+i+":"+n:60<e?i+":"+n:e},n=null,d=document.getElementById(o.canvas),c=d.getContext("2d");return this.start=function(){return m(),a.startTime=o.startTime??new Date,o.seconds&&(a.endTime=new Date(a.startTime.getTime()+1e3*o.seconds)),a.started=!0,a.timer=window.setInterval(function(){t()},100),o.onStart.call(this,a),a},this.pause=function(){if(a.started&&!a.paused)return n=new Date,a.paused=!0,o.onPause.call(this,a),a},this.resume=function(){if(a.started&&a.paused){var e=(new Date).getTime()-n.getTime();return a.endTime=new Date(a.endTime.getTime()+e),a.paused=!1,o.onResume.call(this,a),a}},this.stop=function(){return o.loop=!1,m(),t(),o.onStop.call(this,a),a},this.reset=function(){return m(),o.onReset.call(this,a),a},m(),t(),a};